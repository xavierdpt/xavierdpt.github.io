<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="NetFirewallRule | Xavier's Treasure Trove">
<title>NetFirewallRule | Xavier's Treasure Trove</title>
<style>
*, *::before { box-sizing:border-box;}
a { text-decoration:none;  }
th, td { text-align:left; }
p { margin-top:0; margin-bottom:0;  }
p > code, li > code, td > code { font-size:1.05em; color:#660000; }
code.bnf-token-abstract { border: solid 1px #660000; display:inline-block; padding:5px; font-weight:bold; }
code.bnf-token-metasyntax { border: solid 1px #660000; display:inline-block; padding:5px; }
code.bnf-token-concrete { border-top: solid 1px #660000; border-bottom: solid 1px #660000; display:inline-block;}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/powershell.min.js"></script>
</head>
<body>
<a href="../index.html">Home</a>
 > <a href="index.html">PowerShell</a>
<h1>NetFirewallRule</h1>
<h2>Create a firewall rule</h2>
<p>Firewall rules have a name and a display name. If the name is not given, as is the case here, it is automatically generated</p>
<pre><code class="language-powershell hljs">New-NetFirewallRule -DisplayName "Test rule"
</code></pre>
<h2>Remove a firewall rule by display name</h2>
<p>Note: multiple firewall rules can have the same display name, if you want to remove a specific rule, use the -Name option</p>
<pre><code class="language-powershell hljs">Remove-NetFirewallRule -DisplayName "Test rule"
</code></pre>
<h2>Create a disabled firewall rule</h2>
<p>Firewall rule are enabled by default, this option disables it upon creation.</p>
<pre><code class="language-powershell hljs">New-NetFirewallRule -DisplayName "Test rule" -Enabled False
</code></pre>
<h2>Enable a firewall rule</h2>
<p>A firewall rule can be modified in various ways, here this enables all the rules with the given display name.</p>
<pre><code class="language-powershell hljs">Set-NetFirewallRule -DisplayName "Test rule" -Enabled True
</code></pre>
<h2>Disable new firewall rules by default</h2>
<p>This will se the rules to disabled by default.</p>
<pre><code class="language-powershell hljs">$PSDefaultParameterValues["New-NetFirewallRule:Enabled"]="False"
</code></pre>
<h2>Create a firewall rule with a name</h2>
<p>This creates a firewall rule with a specific name</p>
<pre><code class="language-powershell hljs">New-NetFirewallRule -DisplayName "Test rule" -Name "Test rule"
</code></pre>
<h2>Create an inbound firewall rule</h2>
<p>Firewall rules are inbound by default, but you can specify it to be more clear, or if the default value may be different.</p>
<pre><code class="language-powershell hljs">New-NetFirewallRule -DisplayName "Test rule" -Direction Inbound
</code></pre>
<h2>Create an outbound firewall rule</h2>
<p>This creates an outbound firewall rule.</p>
<pre><code class="language-powershell hljs">New-NetFirewallRule -DisplayName "Test rule" -Direction Outbound
</code></pre>
<h2>Create a firewall rule that allows traffic</h2>
<p>Firewall allows traffic by default, unless the default value has been changed.</p>
<pre><code class="language-powershell hljs">New-NetFirewallRule -DisplayName "Test rule" -Action Allow
</code></pre>
<h2>Create a firewall rule that blocks traffic</h2>
<p>This creates a firewall that blocks traffic. Nothing is actually blocked because this will be handled by other parameters.</p>
<pre><code class="language-powershell hljs">New-NetFirewallRule -DisplayName "Test rule" -Action Block
</code></pre>
<h2>Create a firewall TCP rule</h2>
<p>This creates a TCP rule, which allows traffic and is enabled by default. But more parameter are required for it to do anything.</p>
<pre><code class="language-powershell hljs">New-NetFirewallRule -DisplayName "Test rule" -Protocol TCP
</code></pre>
<h2>Create a firewall TCP rule</h2>
<p>This creates a TCP rule, which allows traffic and is enabled by default. But more parameter are required for it to do anything.</p>
<pre><code class="language-powershell hljs">New-NetFirewallRule -DisplayName "Test rule" -Protocol TCP
</code></pre>
<h2>Create a TCP firewall rule for remote port 443</h2>
<p>Since by default, it allows traffic, it should not be blocked.</p>
<pre><code class="language-powershell hljs">New-NetFirewallRule -DisplayName "Test rule" -Protocol TCP -RemotePort 443
</code></pre>
<h2>Example #1: Block access to all websites</h2>
<pre><code class="language-powershell hljs">New-NetFirewallRule -DisplayName "Test rule" -Protocol TCP -RemotePort 443 -Direction Outbound -Action Block -Enabled True
</code></pre>
<h2>Example #2: Block all outgoing access for TCP</h2>
<pre><code class="language-powershell hljs">New-NetFirewallRule -DisplayName "Test rule" -Protocol TCP -RemotePort Any -Direction Outbound -Action Block -Enabled True
</code></pre>
<h2>Create a TCP firewall rule for local port 80</h2>
<pre><code class="language-powershell hljs">New-NetFirewallRule -DisplayName "Test rule" -Protocol TCP -LocalPort 80
</code></pre>
<h2>Example #3: Allow inbound access to TCP 8080</h2>
<pre><code class="language-powershell hljs">New-NetFirewallRule -DisplayName "Test rule" -Protocol TCP -LocalPort 8080 -Direction Inbound -Action Allow -Enabled True
</code></pre>
<h2>TODO</h2>
<pre><code class="language-powershell hljs">New-NetFirewallRule AsJob ...
New-NetFirewallRule Authentication ...
New-NetFirewallRule CimSession ...
New-NetFirewallRule Confirm ...
New-NetFirewallRule Debug ...
New-NetFirewallRule Description ...
New-NetFirewallRule Direction ...
New-NetFirewallRule DynamicTarget ...
New-NetFirewallRule EdgeTraversalPolicy ...
New-NetFirewallRule Encryption ...
New-NetFirewallRule ErrorAction ...
New-NetFirewallRule ErrorVariable ...
New-NetFirewallRule GPOSession ...
New-NetFirewallRule Group ...
New-NetFirewallRule IcmpType ...
New-NetFirewallRule InformationAction ...
New-NetFirewallRule InformationVariable ...
New-NetFirewallRule InterfaceAlias ...
New-NetFirewallRule InterfaceType ...
New-NetFirewallRule LocalAddress ...
New-NetFirewallRule LocalOnlyMapping ...
New-NetFirewallRule LocalPort ...
New-NetFirewallRule LocalUser ...
New-NetFirewallRule LooseSourceMapping ...
New-NetFirewallRule OutBuffer ...
New-NetFirewallRule OutVariable ...
New-NetFirewallRule OverrideBlockRules ...
New-NetFirewallRule Owner ...
New-NetFirewallRule Package ...
New-NetFirewallRule PipelineVariable ...
New-NetFirewallRule Platform ...
New-NetFirewallRule PolicyStore ...
New-NetFirewallRule Profile ...
New-NetFirewallRule Program ...
New-NetFirewallRule Protocol (other than TCP) ...
New-NetFirewallRule RemoteAddress ...
New-NetFirewallRule RemoteDynamicKeywordAddresses ...
New-NetFirewallRule RemoteMachine ...
New-NetFirewallRule RemotePort ...
New-NetFirewallRule RemoteUser ...
New-NetFirewallRule Service ...
New-NetFirewallRule ThrottleLimit ...
New-NetFirewallRule Verbose ...
New-NetFirewallRule WarningAction ...
New-NetFirewallRule WarningVariable ...
New-NetFirewallRule WhatIf ...
</code></pre>
<script>hljs.highlightAll();</script>
</body>
</html>
