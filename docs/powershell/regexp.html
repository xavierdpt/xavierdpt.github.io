<!DOCTYPE html>
<html>
<head>
<title>Powershell Regular Expressions | Xavier's Treasure Trove</title>
<style>
a { text-decoration:none }
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/powershell.min.js"></script>
</head>
<body>
<a href="../index.html">Home</a>
 > <a href="index.html">Powershell</a>
<h1>Powershell Regular Expressions</h1>
<h2>One char</h2>
<pre><code class="language-powershell hljs">'powershell' -match 'w' # true
'powershell' -match 'x' # false
</code></pre>
<h2>Several consecutive chars</h2>
<pre><code class="language-powershell hljs">'powershell' -match 'power' # true
'powershell' -match 'mega' # false
</code></pre>
<h2>Several chars</h2>
<pre><code class="language-powershell hljs">'powershell' -match '[wxy]' # true
'powershell' -match '[xyz]' # false
</code></pre>
<h2>Several chars or dash</h2>
<p>Include the dash at the beginning or at the end</p>
<pre><code class="language-powershell hljs">'power-shell' -match '[xyz-]' # true
'power-shell' -match '[-xyz]' # true
</code></pre>
<h2>Range of chars</h2>
<pre><code class="language-powershell hljs">'powershell 5' -match '[0-5]' # true
'powershell 6' -match '[0-5]' # false
</code></pre>
<h2>Digits</h2>
<pre><code class="language-powershell hljs">'powershell 5' -match '\d' # true
'powershell' -match '\d' # false
</code></pre>
<h2>Non whitespace</h2>
<pre><code class="language-powershell hljs">'powershell 5' -match '\w' # true
'    ' -match '\w' # false
</code></pre>
<h2>One arbitrary char</h2>
<pre><code class="language-powershell hljs">'powershell' -match 'power.hell' # true
'power shell' -match 'power.hell' # false
</code></pre>
<h2>One arbitrary char</h2>
<pre><code class="language-powershell hljs">'powershell' -match 'power.hell' # true
'power shell' -match 'power.hell' # false
</code></pre>
<h2>Whitespace</h2>
<pre><code class="language-powershell hljs">'powershell 5' -match '\s' # true
'powershell' -match '\s' # false
</code></pre>
<h2>Zero or more</h2>
<pre><code class="language-powershell hljs">'learn shell' -match 'learn (power)*shell' # true
'learn powershell' -match 'learn (power)*shell' # true
'learn powerpowershell' -match 'learn (power)*shell' # true
'learn powerpowerpowershell' -match 'learn (power)*shell' # true
</code></pre>
<h2>One or more</h2>
<pre><code class="language-powershell hljs">'learn shell' -match 'learn (power)+shell' # false
'learn powershell' -match 'learn (power)+shell' # true
'learn powerpowershell' -match 'learn (power)+shell' # true
'learn powerpowerpowershell' -match 'learn (power)+shell' # true
</code></pre>
<h2>Zero or one</h2>
<pre><code class="language-powershell hljs">'learn shell' -match 'learn (power)?shell' # true
'learn powershell' -match 'learn (power)?shell' # true
'learn powerpowershell' -match 'learn (power)?shell' # false
'learn powerlearn powerpowershell' -match 'learn (power)?shell' # false
</code></pre>
<h2>Exactly 2</h2>
<pre><code class="language-powershell hljs">'learn shell' -match 'learn (power){2}shell' # false
'learn powershell' -match 'learn (power){2}shell' # false
'learn powerpowershell' -match 'learn (power){2}shell' # true
'learn powerpowerpowershell' -match 'learn (power){2}shell' # false
</code></pre>
<h2>More than 2</h2>
<pre><code class="language-powershell hljs">'learn shell' -match 'learn (power){2,}shell' # false
'learn powershell' -match 'learn (power){2,}shell' # false
'learn powerpowershell' -match 'learn (power){2,}shell' # true
'learn powerpowerpowershell' -match 'learn (power){2,}shell' # true
'learn powerpowerpowerpowershell' -match 'learn (power){2,}shell' # true
</code></pre>
<h2>1, 2 or 3</h2>
<pre><code class="language-powershell hljs">'learn shell' -match 'learn (power){1,3}shell' # false
'learn powershell' -match 'learn (power){1,3}shell' # true
'learn powerpowershell' -match 'learn (power){1,3}shell' # true
'learn powerpowerpowershell' -match 'learn (power){1,3}shell' # true
'learn powerpowerpowerpowershell' -match 'learn (power){1,3}shell' # false
</code></pre>
<h2>At start of line</h2>
<pre><code class="language-powershell hljs">'powershell' -match '^powershell' # true
'learn powershell' -match '^powershell' # false
</code></pre>
<h2>At end of line</h2>
<pre><code class="language-powershell hljs">'learn' -match 'learn$' # true
'learn powershell' -match 'learn$' # false
</code></pre>
<h2>Escape</h2>
<p>Here, prevent the interpretation of the '.', same for other meta characters such as '^', '$', '*', '+', '?', ...</p>
<pre><code class="language-powershell hljs">'power.shell' -match '\.' # true
'power|shell' -match '\.' # false
</code></pre>
<h2>Compute escaped string with Powershell</h2>
<p>Powershell can perform the escape for you, handy when you have to include untrusted input as a part of a regular expression.</p>
<pre><code class="language-powershell hljs">$user="john.doe"
$regex="Welcome $([regex]::escape($user))"
$regex # Welcome john\.doe
</code></pre>
<h2>Groups</h2>
<pre><code class="language-powershell hljs">'learn powershell' -match 'learn (.*)'
$what = $Matches[1]
$what # powershell
</code></pre>
<h2>Named groups</h2>
<pre><code class="language-powershell hljs">'learn powershell' -match 'learn (?&lt;what&gt;.*)'
$Matches.what # powershell
</code></pre>
<h2>Replace</h2>
<pre><code class="language-powershell hljs">'learn powershell' -replace 'learn','study'
# study powershell
</code></pre>
<h2>Replace with groups</h2>
<pre><code class="language-powershell hljs">'John Doe' -replace '(.*) (.*)','$2, $1'
# Doe, John
</code></pre>
<h2>Replace with named groups</h2>
<pre><code class="language-powershell hljs">'John Doe' -replace '(?&lt;firstname&gt;.*) (?&lt;lastname&gt;.*)','${firstname}, ${lastname}'
# Doe, John
</code></pre>
<h2>Replace with variable in groups</h2>
<pre><code class="language-powershell hljs">$msg="Welcome"
'John Doe' -replace '(?&lt;firstname&gt;.*) (?&lt;lastname&gt;.*)',"$msg `${firstname}, `${lastname}"
# Doe, John
</code></pre>
<h2>Replace and include literal $</h2>
<pre><code class="language-powershell hljs"># With single quotes
'John Doe' -replace '(?&lt;firstname&gt;.*) (?&lt;lastname&gt;.*)','$$ ${firstname}, ${lastname}'
# With double quotes
'John Doe' -replace '(?&lt;firstname&gt;.*) (?&lt;lastname&gt;.*)',"`$`$ `${firstname}, `${lastname}"
# Doe, John
</code></pre>
<h2>References</h2>
<pre><code class="language-powershell hljs">"hello" -replace 'l','($&amp;)
# he(l)(l)o
</code></pre>
<h2>Special chars</h2>
<p>Matches tab, carriage return or newline</p>
<pre><code class="language-powershell hljs">"hello" -match '[\t\r\n]' # false
</code></pre>
<script>hljs.highlightAll();</script>
</body>
</html>
